3: https://youtu.be/oGYinDMDfnA?si=Y3bzpqKo71b7qTcf

select
	count(distinct(emp_id))
from (
select
	*
	, last_value(action) over(partition by emp_id)
from hospital) a
where last_value = 'in';

4. https://youtu.be/PE5MZW1CxOI?si=UeDDMmQQWEqg2WO5

with cte1 as (
select 
	*
	, unnest(string_to_array(filter_room_types, ',')) as room_type
from airbnb_searches),
cte2 as (
select
	room_type
	, count(room_type)
from cte1
group by room_type)

select
	room_type
	, count
from (
select 
	*
	, rank() over(order by count desc)
from cte2) a
where rank = 1;

5.https://youtu.be/TvqKpz9RO-A?si=vhEH2EGzPU4Fhxld

select 
	e1.emp_id
	, e1.name
	, e1.salary
	, e1.dept_id
from emp_salary e1
inner join emp_salary e2
on e1.dept_id=e2.dept_id
where e1.salary = e2.salary and e1.emp_id != e2.emp_id;

6. 